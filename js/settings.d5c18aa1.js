"use strict";(self["webpackChunkxivtodo"]=self["webpackChunkxivtodo"]||[]).push([[472],{343:function(t,e,s){function a(){let t="https://";switch(this.$store.getters.language){case"ja":t+="jp";break;case"de":t+="de";break;case"fr":t+="fr";break;default:t+="na";break}return t+".finalfantasyxiv.com/lodestone/"}s.d(e,{d:function(){return a}})},5161:function(t,e,s){s.r(e),s.d(e,{default:function(){return B}});var a=s(641),r=s(33),n=s(3751);const i={name:"settings-form",id:"settings-form"},o={class:"row"},l={class:"col-lg-6"},d={class:"mb-3"},c={for:"inputCharacterID",class:"form-label"},h=["placeholder"],u={class:"form-text"},g=["href"],p={key:0,type:"submit",id:"settings-save-btn",class:"btn btn-primary",disabled:""},m={key:2,class:"list-group list-group-flush"},f={class:"list-group-item d-flex justify-content-between align-items-start"},k={key:3,class:"list-group list-group-flush"},b={class:"ms-2 me-auto"},C=["src","alt"],v={style:{float:"left"}},L={class:"fw-bold"},y={key:0,class:"text-info"},$={key:1,class:"text-danger"},x=["title"],A={key:2,class:"text-muted"},D={key:0,class:"text-warning"},_=["title"],E=["onClick"],U={class:"tt-text"},S=["href"],N={class:"tt-text"},R=["onClick"],X={class:"tt-text"},O={class:"col-lg-6"},w={key:0,type:"button",id:"settings-save-btn",class:"btn btn-primary",disabled:""};function F(t,e,s,F,P,V){const I=(0,a.g2)("PageHeader"),W=(0,a.g2)("i18n-t"),j=(0,a.g2)("FormRadioSection");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(I,{title:"page.settings",error:this.error,hideNotSignedInAlert:!0,hideNoCharactersAlert:!0},null,8,["error"]),(0,a.Lk)("form",i,[(0,a.Lk)("div",o,[(0,a.Lk)("div",l,[(0,a.Lk)("h2",null,(0,r.v_)(t.$t("settings.characters")),1),(0,a.Lk)("h3",null,(0,r.v_)(t.$t("settings.addNewCharacter")),1),(0,a.Lk)("div",d,[(0,a.Lk)("label",c,(0,r.v_)(t.$t("settings.profileUrl.label")),1),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>P.profileURL=t),type:"text",class:"form-control",id:"inputCharacterID",placeholder:V.getLodestoneURL()+"character/12345/"},null,8,h),[[n.Jo,P.profileURL]]),(0,a.Lk)("div",u,[(0,a.bF)(W,{keypath:"settings.profileUrl.hint"},{default:(0,a.k6)((()=>[(0,a.Lk)("a",{class:"text-reset",href:V.getLodestoneURL()+"character/",target:"_blank",rel:"noopener noreferrer"},"Lodestone",8,g)])),_:1})])]),P.adding?((0,a.uX)(),(0,a.CE)("button",p,[e[9]||(e[9]=(0,a.Lk)("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},null,-1)),(0,a.eW)(" "+(0,r.v_)(t.$t("shared.addingWait")),1)])):((0,a.uX)(),(0,a.CE)("button",{key:1,onClick:e[1]||(e[1]=(...t)=>V.addCharacter&&V.addCharacter(...t)),type:"submit",id:"settings-save-btn",class:(0,r.C4)(["btn btn-primary",{disabled:!P.profileURL}])},(0,r.v_)(t.$t("settings.addCharacter")),3)),e[18]||(e[18]=(0,a.Lk)("br",null,null,-1)),e[19]||(e[19]=(0,a.Lk)("br",null,null,-1)),(0,a.Lk)("h3",null,(0,r.v_)(t.$t("settings.myCharacters")),1),this.$store.getters.hasCharacter?((0,a.uX)(),(0,a.CE)("ul",k,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(this.$store.getters.characters,((s,n)=>((0,a.uX)(),(0,a.CE)("li",{key:s.ID,class:"list-group-item d-flex justify-content-between align-items-start"},[(0,a.Lk)("div",b,[(0,a.Lk)("img",{style:{display:"block",float:"left",height:"50px"},class:"avatar-list d-none d-sm-inline",src:s.lodestoneData.Character.Avatar,alt:t.$t("shared.portraitAlt")},null,8,C),(0,a.Lk)("div",v,[(0,a.Lk)("span",L,(0,r.v_)(s.lodestoneData.Character.Name),1),(0,a.eW)(" – "+(0,r.v_)(s.lodestoneData.Character.World)+" ",1),e[12]||(e[12]=(0,a.Lk)("br",null,null,-1)),this.updating==s.lodestoneData.Character.ID||this.$store.getters.characterOutOfDate(n)?((0,a.uX)(),(0,a.CE)("span",y,[e[10]||(e[10]=(0,a.Lk)("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1)),(0,a.eW)(" "+(0,r.v_)(t.$t("shared.updatingWait")),1)])):s.invalid?((0,a.uX)(),(0,a.CE)("span",$,[(0,a.Lk)("abbr",{title:t.$t("settings.characterNotFoundAlt")},(0,r.v_)(t.$t("settings.characterNotFound")),9,x)])):((0,a.uX)(),(0,a.CE)("span",A,[(0,a.eW)((0,r.v_)(t.$t("settings.lastUpdated",{time:V.lastUpdatedAt(s.updated)}))+" ",1),s.lodestoneData.Achievements&&0!=s.lodestoneData.Achievements.length?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("span",D,[e[11]||(e[11]=(0,a.Lk)("br",null,null,-1)),(0,a.Lk)("abbr",{title:t.$t("settings.achievementsNotPublicAlt")},(0,r.v_)(t.$t("settings.achievementsNotPublic")),9,_)]))]))])]),P.updating||this.$store.getters.characterOutOfDate(n)?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("a",{key:0,class:"text-secondary cursor-pointer tt",onClick:t=>V.updateCharacter(s.lodestoneData.Character.ID)},[e[13]||(e[13]=(0,a.Lk)("i",{class:"fa-fw fas fa-sync-alt"},null,-1)),(0,a.Lk)("span",U,(0,r.v_)(t.$t("shared.update")),1)],8,E)),e[16]||(e[16]=(0,a.eW)("    ")),(0,a.Lk)("a",{class:"text-secondary cursor-pointer tt",href:V.getLodestoneURL()+"character/"+s.lodestoneData.Character.ID+"/",target:"_blank",rel:"noopener noreferrer"},[e[14]||(e[14]=(0,a.Lk)("i",{class:"fa-fw fas fa-external-link"},null,-1)),(0,a.Lk)("span",N,(0,r.v_)(t.$t("shared.lodestone")),1)],8,S),e[17]||(e[17]=(0,a.eW)("    ")),P.updating||this.$store.getters.characterOutOfDate(n)?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("a",{key:1,class:"text-danger cursor-pointer tt",onClick:t=>V.removeCharacter(n)},[e[15]||(e[15]=(0,a.Lk)("i",{class:"fa-fw fas fa-trash-alt"},null,-1)),(0,a.Lk)("span",X,(0,r.v_)(t.$t("shared.remove")),1)],8,R))])))),128))])):((0,a.uX)(),(0,a.CE)("ul",m,[(0,a.Lk)("li",f,(0,r.v_)(t.$t("settings.myCharactersHelp")),1)])),e[20]||(e[20]=(0,a.Lk)("br",null,null,-1))]),(0,a.Lk)("div",O,[(0,a.Lk)("h2",null,(0,r.v_)(t.$t("settings.general")),1),(0,a.bF)(j,{id:"inputSpoilersOption",i18nPrefix:"settings.contentSpoilers.",modelValue:P.settings.spoilersOption,"onUpdate:modelValue":e[2]||(e[2]=t=>P.settings.spoilersOption=t),onRadioChange:e[3]||(e[3]=t=>P.settings.spoilersOption=t),options:[0,1,2]},null,8,["modelValue"]),(0,a.bF)(j,{id:"inputPatchNumsOption",i18nPrefix:"settings.patchNumbers.",modelValue:P.settings.patchNumsOption,"onUpdate:modelValue":e[4]||(e[4]=t=>P.settings.patchNumsOption=t),onRadioChange:e[5]||(e[5]=t=>P.settings.patchNumsOption=t),options:[0,1,2]},null,8,["modelValue"]),(0,a.bF)(j,{id:"inputThemeOption",i18nPrefix:"settings.theme.",modelValue:P.settings.themeOption,"onUpdate:modelValue":e[6]||(e[6]=t=>P.settings.themeOption=t),onRadioChange:e[7]||(e[7]=t=>P.settings.themeOption=t),options:[0,1]},null,8,["modelValue"]),P.updatingSettings?((0,a.uX)(),(0,a.CE)("button",w,[e[21]||(e[21]=(0,a.Lk)("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},null,-1)),(0,a.eW)(" "+(0,r.v_)(t.$t("shared.updatingWait")),1)])):((0,a.uX)(),(0,a.CE)("button",{key:1,onClick:e[8]||(e[8]=(...t)=>V.updateSettings&&V.updateSettings(...t)),type:"button",id:"settings-save-btn",class:"btn btn-primary"},(0,r.v_)(t.$t("settings.updateSettings")),1)),e[22]||(e[22]=(0,a.Lk)("br",null,null,-1)),e[23]||(e[23]=(0,a.Lk)("br",null,null,-1))])])])],64)}var P=s(4304);const V=["onChange","name","id","value","checked"],I=["for"],W={class:"form-text mb-3"};function j(t,e,s,n,i,o){return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("h3",null,(0,r.v_)(t.$t(this.i18nPrefix+"label")),1),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.options,(e=>((0,a.uX)(),(0,a.CE)("div",{key:e,class:"form-check"},[(0,a.Lk)("input",{onChange:s=>t.$emit("radioChange",e),class:"form-check-input",type:"radio",name:s.id,id:s.id+e,value:e,checked:s.modelValue===e},null,40,V),(0,a.Lk)("label",{class:"form-check-label",for:s.id+e},(0,r.v_)(t.$t(this.i18nPrefix+"option"+e)),9,I)])))),128)),(0,a.Lk)("div",W,(0,r.v_)(t.$t(this.i18nPrefix+"hint")),1)],64)}var K={name:"FormRadioSection",props:{modelValue:Number,i18nPrefix:String,id:String,options:Array},emits:["radioChange"]},M=s(6262);const H=(0,M.A)(K,[["render",j]]);var Q=H,q=s(343),J=s(6595),T={name:"SettingsView",data(){return{adding:!1,updatingSettings:!1,updating:0,error:{},profileURL:"",settings:{...this.$store.getters.settings}}},components:{PageHeader:P.A,FormRadioSection:Q},methods:{getLodestoneURL:q.d,updateSettings(){this.updatingSettings=!0,this.error={},(0,J.Xx)(this.settings).then((t=>{this.$store.commit("setSettings",t),this.error={type:"success",msg:this.$t("settings.message.settingsUpdated")}})).catch((t=>{400==t.status?this.error={type:"danger",msg:this.$t("settings.message.settingsUpdateClientError")}:this.error={type:"danger",msg:this.$t("settings.message.settingsUpdateUnknownError")}})).finally((()=>{this.updatingSettings=!1}))},addCharacter(){this.adding=!0,this.error={};let t="0",e=this.profileURL.split("/");for(let s=0;s<e.length;s++)if(Number.isInteger(parseInt(e[s]))){t=e[s];break}(0,J.rq)(t).then((t=>{this.$store.commit("addCharacter",t),t.lodestoneData.Achievements&&0!=t.lodestoneData.Achievements.length?this.error={type:"success",msg:this.$t("settings.message.characterAdded",{name:t.lodestoneData.Character.Name})}:this.error={type:"warning",msg:this.$t("settings.message.characterAddedNotPublic",{name:t.lodestoneData.Character.Name})}})).catch((t=>{console.log(t),404==t.status?this.error={type:"danger",msg:this.$t("settings.message.characterAddNotFoundError")}:400==t.status?this.error={type:"danger",msg:this.$t("settings.message.characterAddClientError")}:this.error={type:"danger",msg:this.$t("settings.message.characterAddServerError")}})).finally((()=>{this.profileURL="",this.adding=!1}))},updateCharacter(t){this.updating=t,this.error={},(0,J.rq)(t).then((t=>{this.$store.commit("addCharacter",t)})).catch((t=>{console.log(t),this.error={type:"danger",msg:t.toString()}})).finally((()=>{this.profileURL="",this.updating=null}))},removeCharacter(t){this.updating=!0,this.error={};let e=this.$store.getters.characters[t].lodestoneData.Character.ID,s=this.$store.getters.characters[t].lodestoneData.Character.Name;confirm(this.$t("settings.message.characterRemoveConfirm",{name:s}))?(0,J.sr)(e).then((()=>{this.$store.commit("removeCharacter",t),this.error={type:"success",msg:this.$t("settings.message.characterRemoved",{name:s})}})).catch((t=>{console.log(t),this.error={type:"danger",msg:this.$t("settings.message.characterRemoveError",{name:s})}})).finally((()=>{this.updating=!1})):this.updating=!1},lastUpdatedAt(t){let e=new Date/1e3,s=e-t,a=Math.floor(s/2592e3),r=Math.floor(s/86400),n=Math.floor(s/3600),i=Math.floor(s/60);return i<2?this.$t("shared.time.coupleSecondsAgo"):i<120?this.$t("shared.time.minutesAgo",{minutes:i}):n<48?this.$t("shared.time.hoursAgo",{hours:n}):r<60?this.$t("shared.time.daysAgo",{days:r}):this.$t("shared.time.monthsAgo",{months:a})}}};const z=(0,M.A)(T,[["render",F]]);var B=z}}]);
//# sourceMappingURL=settings.d5c18aa1.js.map